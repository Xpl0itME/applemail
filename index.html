<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Password + Keystrokes + Device Motion</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    input, button {
      width: 100%;
      padding: 8px;
      margin-top: 10px;
      font-size: 14px;
    }
    .box {
      margin-top: 15px;
      padding: 10px;
      border: 1px solid #ccc;
      background: #f9f9f9;
      font-family: monospace;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>

<h2>Password + Keystrokes + Device Motion</h2>

<label>Password field:</label>
<input
  type="password"
  id="passwordBox"
  placeholder="Type password here"
/>

<button onclick="enableMotion()">Enable Device Motion</button>

<div class="box" id="keystrokes">Keystrokes:\n</div>
<div class="box" id="motion">Device Motion:\n</div>

<script>
  const passwordBox = document.getElementById("passwordBox");
  const keystrokes = document.getElementById("keystrokes");
  const motionBox = document.getElementById("motion");

  /* --------------------
     KEYSTROKE LOGGING
  -------------------- */
  passwordBox.addEventListener("keydown", (e) => {
    keystrokes.textContent +=
      `key="${e.key}" code="${e.code}" shift=${e.shiftKey}\n`;
    keystrokes.scrollTop = keystrokes.scrollHeight;
  });

  /* --------------------
     DEVICE MOTION
  -------------------- */
  function enableMotion() {
    if (typeof DeviceMotionEvent === "undefined") {
      motionBox.textContent = "DeviceMotion API not supported.";
      return;
    }

    // iOS requires explicit permission
    if (typeof DeviceMotionEvent.requestPermission === "function") {
      DeviceMotionEvent.requestPermission()
        .then(permission => {
          if (permission === "granted") {
            startMotion();
          } else {
            motionBox.textContent = "Device motion permission denied.";
          }
        })
        .catch(err => {
          motionBox.textContent = "Permission error: " + err;
        });
    } else {
      // Android / Desktop
      startMotion();
    }
  }

  function startMotion() {
    window.addEventListener("devicemotion", (event) => {
      const a = event.accelerationIncludingGravity;
      const r = event.rotationRate;

      motionBox.textContent =
        "Acceleration (m/sÂ²)\n" +
        `x: ${a?.x?.toFixed(2)}\n` +
        `y: ${a?.y?.toFixed(2)}\n` +
        `z: ${a?.z?.toFixed(2)}\n\n` +
        "Rotation (deg/s)\n" +
        `alpha: ${r?.alpha?.toFixed(2)}\n` +
        `beta: ${r?.beta?.toFixed(2)}\n` +
        `gamma: ${r?.gamma?.toFixed(2)}`;
    });
  }
</script>

</body>
</html>
